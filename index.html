<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src 'self';" />
  <meta name="referrer" content="strict-origin" />
  <title>未成年課金返金申請フォーム | refund.example.com</title>
  <style>
    :root {
      --bg:#fff; --fg:#111; --muted:#6b7280; --border:#e5e7eb; --warn:#b91c1c; --primary:#007bff; --focus:#2563eb; --success:#10b981;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg)}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;font-size:14px;line-height:1.6}

    .container{max-width:720px;margin:0 auto;padding:16px}
    .card{background:#fff;border:1px solid var(--border);border-radius:12px;padding:16px;margin:12px 0;box-shadow:0 1px 2px rgba(0,0,0,.03)}
    .page-header{text-align:center;margin-bottom:20px}
    .page-title{color:var(--primary);font-size:24px;margin:0 0 8px 0}
    .page-subtitle{color:var(--muted);font-size:14px;margin:0}
    .security-badge{display:inline-flex;align-items:center;gap:4px;background:#f0f9ff;color:#0369a1;font-size:12px;padding:4px 8px;border-radius:12px;margin-top:8px}

    .notice{margin-bottom:8px;color:var(--muted);font-size:13px;line-height:1.7}
    .notice strong{color:var(--fg)}

    .field{display:block;margin:12px 0}
    .field>span{display:inline-block;margin-bottom:6px;font-weight:600}
    .req{background:#fee2e2;color:#991b1b;font-size:12px;border-radius:4px;padding:2px 6px;margin-left:6px}

    input[type="text"],input[type="email"],input[type="tel"],select{
      width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:8px;font-size:14px
    }
    input:focus,select:focus{outline:none;border-color:var(--focus);box-shadow:0 0 0 3px rgba(37,99,235,.15)}

    .hint{color:var(--muted);font-size:12px;display:block;margin-top:4px}
    .error{color:#b91c1c;font-size:12px;min-height:16px;display:block;margin-top:4px}

    .tabs{display:flex;gap:8px;margin-bottom:8px}
    .tab{padding:8px 12px;border:1px solid var(--border);background:#f9fafb;border-radius:20px;cursor:pointer}
    .tab.active{border-color:var(--primary);background:#eef6ff}
    .tabpane{padding:8px 0}
    .tabpane[hidden]{display:none}
    .tabpane.active{display:block}

    .agree{display:flex;align-items:flex-start;gap:8px;margin-top:12px}
    .agree input{margin-top:3px}

    .purpose-confirm{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:16px;margin:12px 0}
    .purpose-confirm h3{margin:0 0 8px 0;color:var(--primary);font-size:16px}
    .purpose-confirm p{margin:0 0 12px 0;color:var(--muted);font-size:14px}

    .actions{display:flex;align-items:center;gap:12px;margin-top:12px}
    button[type="submit"]{background:var(--primary);color:#fff;border:none;border-radius:8px;padding:10px 16px;font-size:14px;cursor:pointer;transition:transform .02s ease}
    button[disabled]{opacity:.5;cursor:not-allowed}
    button:active{transform:translateY(1px)}
    .submit-note{font-size:12px;color:var(--muted)}

    .privacy{color:#4b5563;font-size:12px;line-height:1.7}
    .footer{text-align:center;color:var(--muted);font-size:12px;padding:16px 0 8px}
  </style>
</head>
<body>
  <main class="container" role="main" aria-labelledby="page-title">
    <div class="page-header">
      <h1 id="page-title" class="page-title">未成年課金返金申請フォーム</h1>
      <p class="page-subtitle">未成年によるご利用について、保護者・親権者さまが返金を申請するためのフォームです</p>
      <div class="security-badge">
        🔒 セキュア送信対応
      </div>
    </div>

    <section class="card">
      <div class="notice">
        <strong>ご案内：</strong>  
        このフォームでは、未成年によるご利用があった場合に、保護者・親権者さまから返金申請を受け付けます。  
        いただいた内容は、事実確認を行ったうえで適切に対応いたします。<br>
        内容に虚偽があった場合は、返金対象外となりますのでご了承ください。
      </div>

      <form id="refundForm" novalidate>
        <!-- 隠しフィールド（セキュリティトークン） -->
        <input type="hidden" name="securityToken" id="securityToken" />
        <input type="hidden" name="formTimestamp" id="formTimestamp" />
        <input type="hidden" name="sessionId" id="sessionId" />

        <label class="field">
          <span>対象ドメイン（分かる場合のみ）</span>
          <input type="text" name="targetDomain" id="targetDomain" placeholder="例: example.com" inputmode="url" autocomplete="off" maxlength="253" />
          <small class="hint">URLでも可。不明な場合は空欄でも構いません。</small>
        </label>

        <label class="field">
          <span>サービス名（分かる場合のみ）</span>
          <input type="text" name="serviceName" id="serviceName" maxlength="100" placeholder="例: 電子書籍コムなど" />
        </label>

        <label class="field">
          <span>キャリア <span class="req">必須</span></span>
          <select name="carrier" id="carrier" required>
            <option value="">選択してください</option>
            <option value="docomo">docomo（ahamo）</option>
            <option value="au">au（povo、UQ mobile）</option>
            <option value="softbank">SoftBank（LINEMO）</option>
          </select>
        </label>

        <label class="field">
          <span id="paymentIdLabel">対象の決済番号 <span class="req">必須</span></span>
          <input type="text" name="paymentId" id="paymentId" required placeholder="例: xxxx-xxxx-xxxx" maxlength="50" />
          <small class="hint" id="paymentIdHint">※ 不明な場合は確認方法をご覧ください。</small>
        </label>

        <div class="purpose-confirm">
          <h3>申請内容の確認</h3>
          <p>以下にご同意いただいたうえで送信してください。</p>
          <label class="agree">
            <input type="checkbox" name="reasonConfirm" id="reasonConfirm" required />
            <span>未成年による課金であることを確認し、返金申請を行います</span>
          </label>
        </div>

        <label class="field">
          <span>生年月日（YYYY/MM/DD） <span class="req">必須</span></span>
          <input type="text" name="dob" id="dob" placeholder="例: 2008/03/05" required maxlength="10" />
        </label>

        <label class="field">
          <span>親権者/保護者の氏名 <span class="req">必須</span></span>
          <input type="text" name="guardianName" id="guardianName" maxlength="50" required placeholder="例: 山田 太郎" />
        </label>

        <fieldset class="field">
          <legend>親権者/保護者の連絡先 <span class="req">必須</span></legend>
          <div class="tabs">
            <button type="button" class="tab active" data-target="#emailPane">メール</button>
            <button type="button" class="tab" data-target="#phonePane">電話</button>
          </div>

          <div id="emailPane" class="tabpane active">
            <label class="subfield">
              <span>メールアドレス</span>
              <input type="email" name="guardianEmail" id="guardianEmail" maxlength="100" />
            </label>
          </div>

          <div id="phonePane" class="tabpane" hidden>
            <label class="subfield">
              <span>電話番号</span>
              <input type="tel" name="guardianPhone" id="guardianPhone" maxlength="20" />
            </label>
          </div>
        </fieldset>

        <label class="agree">
          <input type="checkbox" id="consent" required />
          <span>記入内容に誤りがないことを確認し、事実確認のうえで対応されることに同意します。</span>
        </label>

        <div class="actions">
          <button id="submitBtn" type="submit" disabled>申請を送信</button>
          <div id="submitNote" class="submit-note" aria-live="polite"></div>
        </div>
      </form>
    </section>

    <section class="card">
      <p class="privacy">
        収集目的：返金申請の確認・対応、および不正防止<br>
        収集情報：生年月日、親権者氏名・連絡先、対象ドメイン、キャリア、決済番号<br>
        保管期間：申請処理後一定期間後に削除<br>
        第三者提供：キャリア決済事業者に年齢確認のため提供する場合あり<br>
        お問い合わせ：support@refund.example.com
      </p>
    </section>

    <footer class="footer">
      <small>&copy; 2025 refund.example.com</small>
    </footer>
  </main>
  <script src="form.js"></script>
</body>
</html>
